var jsLoadMore=function(s,a){var n,t,i,d,r,l,c,m=0,u=!0,f=Modernizr.srcset,p=0,j=null,v={imgLoadingTimeout:2e4,itemsDelay:100};function h(){var e,s=i.find("> *").slice(0,r),a=s.find("img"),o=a.length,n=[];o?$.each(a,function(e){var o=$(this),s=new Image,a=$.Deferred();n.push(a.promise()),s.onload=function(){a.resolve(o)},setTimeout(function(){"resolved"!==a.state()&&a.resolve(o)},v.imgLoadingTimeout),f&&void 0!==o.data("srcset")?(o.prop("srcset",o.data("srcset")),s.srcset=o.prop("srcset")):(void 0!==o.data("src")&&o.prop("src",o.data("src")),s.src=o.prop("src"))}):(e=$.Deferred(),n.push(e.promise()),e.resolve()),$.when.apply($,n).done(function(){var e=s.eq(0).closest(".js-mas-backup").length,o=s.eq(0).closest(".js-jg-backup").length;s.addClass("js-loadmore-moved").css("visibility","hidden"),o?s.css("position","absolute").insertAfter(t):s.appendTo(t),e?setTimeout(function(){t.masonry("appended",s),g(s)},100):o?setTimeout(function(){a.each(function(e){var o=$(this);o.attr("src",o[0].currentSrc).removeAttr("srcset"),o.closest(".js-loadmore-moved").css("visibility","")}),jsJustifiedGallery.appendImgLoaded(a,function(){t.find(".js-lb-init-late").removeClass("js-lb-init-late"),"undefined"!=typeof jsLB&&jsLB.init(t)}),g(s,!0)},100):g(s),isIE8?(d.addClass("waitBefore"),setTimeout(function(){d.removeClass("waitBefore js-loadmore-loading"),i.find("> *").filter(":not(.js-loadmore-dummy)").length||d.addClass("js-loadmore-btn--all-loaded"),i.find(".js-loadmore-dummy").remove()},400)):(d.removeClass("js-loadmore-loading"),i.find("> *").length||d.addClass("js-loadmore-btn--all-loaded"),i.find(".js-loadmore-dummy").remove())}).fail(function(){}).then(function(){})}function g(e,o){var s=e;s.css("visibility",""),s.each(function(e){var o=$(this);o.data("loadmore-animatecss")?(o.css(prefix.css+"animation-delay",e*v.itemsDelay+"ms").addClass("animated "+o.data("loadmore-animatecss")),o.one(cssAniEnd,function(){o.css(prefix.css+"animation-delay","")})):(o.css(prefix.css+"transition-delay",e*v.itemsDelay+"ms"),o.one(cssTransEnd,function(){o.css(prefix.css+"transition-delay","")}))}),setTimeout(function(){s.removeClass("js-mas-init"),m=0,a&&a.onMoved&&a.onMoved(s,t)},50),o&&e.remove()}return{init:function(e,o){n=s,t=$(".js-loadmore-container",n),i=$(".js-loadmore-backup",n),d=$(".js-loadmore-btn",n),r=parseInt(t.data("loadmore")),j=t.data("loadmore-ajax"),c=!!j,(l=t.data("loadmore-ajax-page"))&&(p=l),e&&(v=$.extend({},v,e)),t.length&&((t.hasClass("js-mas")||t.hasClass("js-jg-container"))&&(u=!1),d.on("click",function(e){e.preventDefault(),1!=m&&u&&(m=1,d.addClass("js-loadmore-loading"),p++,c?$.ajax({url:j.replace("{page}",p)}).done(function(e){i.append(e),h()}):h())}),t.hasClass("js-loadmore-scorll")&&$(window).on("scroll.jsloadmore",function(e){var o,s=$(".js-loadmore-btn");s.length&&(o=$(window).scrollTop(),s.offset().top<=o+$(window).height()&&s.click())}),t.data("loadmore-options",v))},removeUnready:function(){u=!0},getLoadmoreOpts:function(e){return e.data("loadmore-options")}}},jsLoadMoreInit={init:function(){$(".js-loadmore-outer").each(function(){var e,o=$(this);o.data("js-loadmore")||(e=new jsLoadMore(o,{onMoved:function(e,o){console.log("ss"),jsPhotoList.setPos()}}),o.data("js-loadmore",e),e.init())})}};